(()=>{"use strict";var e={getPoints:function(e){return this.pointsByAmount[e]},colors:{1:"#7fea83",2:"#ff7575",3:"#91c1f4",4:"#eef872",5:"#f2ad61",6:"#ffaefb",7:"#a2f2d6",8:"#c3b0a4",9:"#afe66c"},pointsByAmount:{1:[[[1,1],[0,1],[0,0],[1,0],[1,1]]],2:[[[.66,1],[0,1],[0,0],[.33,0],[.66,1]],[[.66,1],[1,1],[1,0],[.33,0],[.66,1]]],3:[[[.66,1],[0,1],[0,.33],[.5,.5],[.66,1]],[[0,.33],[0,0],[1,0],[.5,.5],[0,.33]],[[1,0],[1,1],[.66,1],[.5,.5],[1,0]]],4:[[[.66,1],[0,1],[0,.66],[.5,.5],[.66,1]],[[0,.66],[0,0],[.33,0],[.5,.5],[0,.66]],[[.33,0],[1,0],[1,.33],[.5,.5],[.33,0]],[[1,.33],[1,1],[.66,1],[.5,.5],[1,.33]]],5:[[[.66,1],[0,1],[0,.8],[.5,.5],[.66,1]],[[0,.8],[0,0],[.5,.5],[0,.8]],[[0,0],[.8,0],[.5,.5],[0,0]],[[.8,0],[1,0],[1,.5],[.5,.5],[.8,0]],[[1,.5],[1,1],[.66,1],[.5,.5],[1,.5]]],6:[[[.66,1],[0,1],[.5,.5],[.66,1]],[[0,1],[0,.33],[.5,.5],[.1]],[[0,.33],[0,0],[.33,0],[.5,.5],[0,.33]],[[.33,0],[1,0],[.5,.5],[.33,0]],[[1,0],[1,.66],[.5,.5],[1,0]],[[1,.66],[1,1],[.66,1],[.5,.5],[1,.66]]],7:[[[.66,1],[.1,1],[.5,.5],[.66,1]],[[.1,1],[0,1],[0,.53],[.5,.5],[.1,1]],[[0,.53],[0,0],[.5,.5],[0,.53]],[[0,0],[.66,0],[.5,.5],[0,0]],[[.66,0],[1,0],[1,.2],[.5,.5],[.66,0]],[[1,.2],[1,.77],[.5,.5],[1,.2]],[[1,.77],[1,1],[.66,1],[.5,.5],[1,.77]]],8:[[[.66,1],[.16,1],[.5,.5],[.66,1]],[[.16,1],[0,1],[0,.66],[.5,.5],[.16,1]],[[0,.66],[0,.16],[.5,.5],[0,.66]],[[0,.16],[0,0],[.33,0],[.5,.5],[0,.16]],[[.33,0],[.83,0],[.5,.5],[.33,0]],[[.83,0],[1,0],[1,.33],[.5,.5],[.83,0]],[[1,.33],[1,.83],[.5,.5],[1,.33]],[[1,.83],[1,1],[.66,1],[.5,.5],[1,.83]]],9:[[[.66,1],[.15,1],[.5,.5],[.66,1]],[[.15,1],[0,1],[0,.7],[.5,.5],[.15,1]],[[0,.7],[0,.26],[.5,.5],[0,.7]],[[0,.26],[0,0],[.18,0],[.5,.5],[0,.26]],[[.18,0],[.64,0],[.5,.5],[.18,0]],[[.64,0],[1,0],[.5,.5],[.64,0]],[[1,0],[1,.4],[.5,.5],[1,0]],[[1,.4],[1,.85],[.5,.5],[1,.4]],[[1,.85],[1,1],[.66,1],[.5,.5],[1,.85]]]}},t=function(e){for(var t=JSON.stringify(e),n=0,i=0;i<t.length;i++)n=(n<<5)-n+t.charCodeAt(i),n&=n;return n};function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o={elem:{},color:"",solvingColor:"",cellSize:0,padding:0,data:{},selection:[],isCtrlPressed:!1,thinLineThickness:0,fatLineThickness:0,problemNumbers:[],init:function(){this.elem=document.getElementById("board-canvas"),this.color="#50504e",this.solvingColor="#3369b1";var e=this.elem;this.cellSize=100,this.padding=10,e.height=0,e.width=0,o.thinLineThickness=2,o.fatLineThickness=5,this.data=JSON.parse('{"rows":9,"columns":9,"borders":{"verticalArray":[[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2],[2,1,1,2,1,1,2,1,1,2]],"horizontalArray":[[2,2,2,2,2,2,2,2,2,2],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[2,2,2,2,2,2,2,2,2,2],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[2,2,2,2,2,2,2,2,2,2],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[2,2,2,2,2,2,2,2,2,2]]},"values":[[7,5,6,1,2,3,4,9,8],[9,2,4,6,7,8,1,3,5],[3,1,8,4,5,9,7,2,6],[1,3,7,5,9,4,8,6,2],[2,4,9,8,6,7,3,5,1],[6,8,5,3,1,2,9,7,4],[4,9,2,7,8,6,5,1,3],[5,7,3,2,4,1,6,8,9],[8,6,1,9,3,5,2,0,0]],"solving":[[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]],[[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]],[0,[],[]]]],"twins":[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],"inequals":{"horizontal":[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],"vertical":[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]]},"cross":0,"chains":[],"blockOutlines":[],"solvingHashSum":673141253,"name":"10"}'),o.selection=o.createSimpleArray(this.data.rows,this.data.columns,!1),this.data.painting=this.createPaintingArray(this.data.rows,this.data.columns),this.setClearProblemNumbers(),this.solvingStack.step()},createSimpleArray:function(e,t,n){for(var i=[],o=0;o<e;o++){for(var r=[],a=0;a<t;a++)r.push(n);i.push(r)}return i},createPaintingArray:function(e,t){for(var n=[],i=0;i<e;i++){for(var o=[],r=0;r<t;r++)o.push([]);n.push(o)}return n},updateProblemNumbers:function(e){var t=function(e){var t=e.reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),[0,0,0,0,0,0,0,0,0]),n=[];t.forEach((function(e,t){e>1&&n.push(t)}));var i=[];return e.forEach((function(e,t){-1!=n.indexOf(e)&&i.push(t)})),i};e.setClearProblemNumbers();var n=function(e){for(var t=JSON.parse(JSON.stringify(e.data.values)),n=0;n<e.data.rows;n++)for(var i=0;i<e.data.rows;i++){var o=e.data.values[n][i],r=e.data.solving[n][i][0];t[n][i]=o||r}return t}(e);!function(t,n){t.forEach((function(t,i){n(t).forEach((function(t,n){e.problemNumbers[i][t]=!0}))}))}(n,t),function(t,n){for(var i=function(i){for(var o=[],r=0;r<t.length;r++)o.push(t[r][i]);n(o).forEach((function(t,n){e.problemNumbers[t][i]=!0}))},o=0;o<t.length;o++)i(o)}(n,t),function(t,n){for(var i=[[],[],[],[],[],[],[],[],[]],o=function(e,t){return e<3&&t<3?1:e>=3&&e<6&&t<3?2:e>=6&&t<3?3:e<3&&t>=3&&t<6?4:e>=3&&e<6&&t>=3&&t<6?5:e>=6&&t>=3&&t<6?6:e<3&&t>=6?7:e>=3&&e<6&&t>=6?8:e>=6&&t>=6?9:void 0},r=0;r<t.length;r++)for(var a=0;a<t.length;a++)i[o(a,r)-1].push(t[r][a]);i.forEach((function(t,i){n(t).forEach((function(t,n){var o=function(e,t){var n={1:[0,0],2:[3,0],3:[6,0],4:[0,3],5:[3,3],6:[6,3],7:[0,6],8:[3,6],9:[6,6]}[e+1],i={1:[0,0],2:[1,0],3:[2,0],4:[0,1],5:[1,1],6:[2,1],7:[0,2],8:[1,2],9:[2,2]}[t+1];return[n[0]+i[0],n[1]+i[1]]}(i,t),r=o[0],a=o[1];e.problemNumbers[a][r]=!0}))}))}(n,t)},setClearProblemNumbers:function(){this.problemNumbers=this.createSimpleArray(this.data.rows,this.data.columns,!1)},checkSolving:function(e){for(var t=JSON.parse(JSON.stringify(this.data.values)),n=0;n<this.data.rows;n++)for(var i=0;i<this.data.rows;i++){var o=this.data.values[n][i],r=this.data.solving[n][i][0];if(t[n][i]=o||r,0==o&&0==r)return}e(t)==this.data.solvingHashSum&&(document.getElementById("final-screen").style.display="block")},solvingStack:{array:[],maxLength:50,currentIndex:0,maxIndex:0,step:function(){this.removeTail(),this.pushSolving();var e=this.array.length;e>this.maxLength&&this.array.shift(),e=this.array.length,this.currentIndex=this.maxIndex=e-1},back:function(){this.currentIndex<=0||(this.currentIndex-=1,this.useSolving(),o.draw())},forward:function(){this.currentIndex>=this.maxIndex||(this.currentIndex+=1,this.useSolving(),o.draw())},removeTail:function(){this.array.splice(this.currentIndex+1)},pushSolving:function(){var e=JSON.parse(JSON.stringify(o.data.solving));this.array.push(e)},useSolving:function(){var e=JSON.parse(JSON.stringify(this.array[this.currentIndex]));o.data.solving=e}},moveSelection:function(e){var t=0,n=0,i=0,r=0;e:for(n in o.selection)for(t in o.selection[n])if(1==o.selection[n][t]){t=+t,n=+n;break e}if("ArrowUp"==e){if(0==n)return;i=t,r=n-1}else if("ArrowDown"==e){if(n==o.data.rows-1)return;i=t,r=n+1}else if("ArrowLeft"==e){if(0==t)return;i=t-1,r=n}else if("ArrowRight"==e){if(t==o.data.columns-1)return;i=t+1,r=n}o.selection[n][t]=!1,o.selection[r][i]=!0,o.draw()},deSelectAll:function(){for(var e in this.selection)for(var t in this.selection[e])this.selection[e][t]=!1},selectAll:function(){for(var e in this.selection)for(var t in this.selection[e])this.selection[e][t]=!0},getSelected:function(){var e=o.selection;selectedArray=[];for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)1==e[t][n]&&selectedArray.push([n,t]);return selectedArray},getCoordsByIndexes:function(e,t){var n=o.padding,i=o.cellSize,r=[0,0];return r[0]=n+e*i,r[1]=n+t*i,r},draw:function(){var t=this.elem,i=o.cellSize,r=o.padding;t.height=this.data.rows*i+2*r,t.width=this.data.columns*i+2*r;var l,s,c=t.getContext("2d"),d=function(e,t,n,i,r){var a=o.elem.getContext("2d");a.beginPath(),a.setLineDash([2,5]),a.moveTo(e,t),a.lineTo(n,i),a.strokeStyle=o.color,r&&(a.strokeStyle="#3fe94d"),a.lineWidth=o.thinLineThickness,a.stroke()},u=function(e,t,n){var i=o.elem.getContext("2d");i.beginPath(),i.fillStyle="#ffffff",i.rect(e+20,t+5,60,20),i.fill(),i.font="".concat(20,"px Roboto-Medium-numbers-only"),i.textAlign="center",i.fillStyle=o.color,i.fillText(n,e+50,t+20),i.textAlign="left"},f=function(e,t){var n,i,r=90,a=o.cellSize,l=e[0],s=e[1];return 1==t?(n=l+a-r,i=s+a-r):2==t?(n=l+r,i=s+a-r):3==t?(n=l+a-r,i=s+r):4==t&&(n=l+r,i=s+r),[n,i]};!function(){var t=o.elem.getContext("2d");for(var n in o.data.painting)for(var i in o.data.painting[n]){var r=o.data.painting[n][i],a=r.length;if(0==r.length)return;var l=e.getPoints(a);for(var s in l){var c=e.colors[r[s]];for(var d in t.fillStyle=c,t.beginPath(),l[s]){var u=l[s][d],f=o.getCoordsByIndexes(i,n),v=f[0]+u[0]*o.cellSize,g=f[1]+u[1]*o.cellSize;(d=0)?t.moveTo(v,g):t.lineTo(v,g)}t.fill()}}}(),function(){c.lineCap="round";for(var e=0;e<o.data.rows;e++)for(var t=0;t<=o.data.columns;t++){c.beginPath();var n=o.data.borders.verticalArray[e][t];if(0!=n){if(1==n){var a=o.thinLineThickness;c.lineWidth=a}else if(2==n){var l=o.fatLineThickness;c.lineWidth=l}var s=0+r+t*i,d=0+r+e*i,u=0+r+t*i,f=0+r+e*i+i;c.moveTo(s,d),c.lineTo(u,f),c.strokeStyle=o.color,c.stroke()}}for(var v=0;v<=o.data.rows;v++)for(var g=0;g<o.data.columns;g++){c.beginPath();var m=o.data.borders.horizontalArray[v][g];if(0!=m){if(1==m){var h=o.thinLineThickness;c.lineWidth=h}else if(2==m){var y=o.fatLineThickness;c.lineWidth=y}var p=0+r+g*i,w=0+r+v*i,b=0+r+g*i+i,S=0+r+v*i;c.moveTo(p,w),c.lineTo(b,S),c.strokeStyle=o.color,c.stroke()}}}(),function(){var e=o.elem,t=(e.getContext("2d"),o.padding),n=o.data.cross;if(0!=n)if(1==n){var i=0+t,r=e.height-t,a=e.width-t;d(i,r,a,0+t,!1)}else if(2==n){var l=0+t,s=0+t,c=e.width-t,u=e.height-t;d(l,s,c,u,!1)}else if(3==n){var f=0+t,v=e.height-t,g=e.width-t;d(f,v,g,0+t,!1);var m=0+t,h=0+t,y=e.width-t,p=e.height-t;d(m,h,y,p,!1)}}(),function(){var e,t=n(o.data.chains);try{for(t.s();!(e=t.n()).done;)for(var i=e.value,r=0;r<i.length-1;r++){var a=i[r][0],l=i[r][1],s=i[r+1][0],c=i[r+1][1],u=o.getCoordsByIndexes(a,l),f=o.getCoordsByIndexes(s,c);u[0]=u[0]+Math.round(o.cellSize/2),u[1]=u[1]+Math.round(o.cellSize/2),f[0]=f[0]+Math.round(o.cellSize/2),f[1]=f[1]+Math.round(o.cellSize/2),d(u[0],u[1],f[0],f[1],!1)}}catch(e){t.e(e)}finally{t.f()}}(),function(){if(0!=Object.keys(o.data.blockOutlines).length){var e,t=n(o.data.blockOutlines);try{for(t.s();!(e=t.n()).done;){for(var i=e.value,r=i.text,a=i.stepsArray,l=i.isSelected,s=0;s<a.length-1;s++){var c=a[s][2],v=a[s+1][2],g=a[s][0],m=a[s][1],h=a[s+1][0],y=a[s+1][1],p=f(o.getCoordsByIndexes(g,m),c),w=f(o.getCoordsByIndexes(h,y),v);d(p[0],p[1],w[0],w[1],l)}if(""!=r){var b=o.getCoordsByIndexes(a[0][0],a[0][1]);u(b[0],b[1],r)}}}catch(e){t.e(e)}finally{t.f()}}}(),function(){var e=o.elem.getContext("2d"),t=function(t,n,i,r){e.beginPath(),e.setLineDash([]),e.lineWidth=o.fatLineThickness,e.moveTo(t,n),e.lineTo(i,r),e.strokeStyle=o.color,e.stroke()};for(var n in o.data.twins)for(var i in o.data.twins[n]){i=+i,n=+n;var r=o.data.twins[n][i],a=o.getCoordsByIndexes(i+1,n+1),l=o.cellSize/5;0!=r&&(1==r?t(a[0]-l,a[1]+l,a[0]+l,a[1]-l):2==r?t(a[0]-l,a[1]-l,a[0]+l,a[1]+l):3==r&&(t(a[0]-l,a[1]+l,a[0]+l,a[1]-l),t(a[0]-l,a[1]-l,a[0]+l,a[1]+l)))}}(),function(){var e=o.elem.getContext("2d"),t=function(t,n,i,r){e.beginPath(),e.setLineDash([]),e.lineWidth=o.fatLineThickness,e.moveTo(t,n),e.lineTo(i,r),e.strokeStyle=o.color,e.stroke()};for(var n in o.data.inequals.horizontal)for(var i in o.data.inequals.horizontal[n]){i=+i,n=+n;var r=o.data.inequals.horizontal[n][i],a=o.getCoordsByIndexes(i+1,n);a[1]=a[1]+o.cellSize/2;var l=o.cellSize/6,s=o.cellSize/6;if(0!=r)if(1==r){var c=a[0]-l,d=a[1],u=a[0]+l,f=a[1]+s;t(c,d,u,f),t(c=a[0]-l,d=a[1],u=a[0]+l,f=a[1]-s)}else if(2==r){var v=a[0]+l,g=a[1],m=a[0]-l,h=a[1]+s;t(v,g,m,h),t(v=a[0]+l,g=a[1],m=a[0]-l,h=a[1]-s)}}for(var y in o.data.inequals.vertical)for(var p in o.data.inequals.vertical[y]){p=+p,y=+y;var w=o.data.inequals.vertical[y][p],b=o.getCoordsByIndexes(p,y+1);b[0]=b[0]+o.cellSize/2;var S=o.cellSize/6,k=o.cellSize/6;if(0!=w)if(3==w){var x=b[0],L=b[1]-k,I=b[0]+S,C=b[1]+k;t(x,L,I,C),t(x=b[0],L=b[1]-k,I=b[0]-S,C=b[1]+k)}else if(4==w){var A=b[0],T=b[1]+k,B=b[0]+S,E=b[1]-k;t(A,T,B,E),t(A=b[0],T=b[1]+k,B=b[0]-S,E=b[1]-k)}}}(),function(){var e=o.elem.getContext("2d");for(var t in o.data.values)for(var n in o.data.values[t])if(0!=o.data.values[t][n]){var i=o.getCoordsByIndexes(n,t),r=i[0]+28,a=i[1]+80,l=o.data.values[t][n];1==String(l).length?(r=i[0]+28,a=i[1]+80,e.font="80px Roboto-Medium-numbers-only"):2==String(l).length&&(r=i[0]+28,a=i[1]+88,e.font="36px Roboto-Medium-numbers-only"),e.fillStyle=o.color,e.fillText(l,r,a)}}(),function(){if(0!=a.visible){var e=function(e){var t=function(t){if(0!=o.data.values[e][t]&&1==o.data.values[e][t].toString().length)return 1;if(0!=o.data.solving[e][t][0]){var n=o.data.solving[e][t][0],i=o.getCoordsByIndexes(t,e),r=i[0]+o.cellSize/2,a=i[1]+80;c.font="80px Roboto-Medium-numbers-only",c.textAlign="center",c.fillStyle=o.solvingColor,c.fillText(n,r,a)}else{var l=function(n,i,o,r){var a=function(e,t,n,i,o,r){e.font="".concat(t,"px Roboto-Medium-numbers-only"),e.textAlign="center",e.fillStyle=n,e.fillText(i,o,r)},l=o.getCoordsByIndexes(t,e),s=l[0]+o.cellSize/2;if("one-row"==n){var c=l[1]+62;a(i,32,o.solvingColor,r,s,c)}else{var d=l[1]+45,u=l[1]+75,f=Math.ceil(r.length/2),v=r.split("").slice(0,f).join(""),g=r.split("").slice(f).join("");a(i,32,o.solvingColor,v,s,d),a(i,32,o.solvingColor,g,s,u)}},s=o.data.solving[e][t][1].join("");0!=s.length&&(s.length<=5?l("one-row",c,o,s):l("two-rows",c,o,s));var d=o.data.solving[e][t][2],u=0,f=0;for(var v in d){var g=d[v];if(0==v&&(u=-35,f=-25),1==v&&(u=35,f=-25),2==v&&(u=-35,f=45),3==v&&(u=35,f=45),4==v)break;var m=o.getCoordsByIndexes(t,e),h=m[0]+o.cellSize/2+u,y=m[1]+o.cellSize/2+f;c.font="30px Roboto-Medium-numbers-only",c.textAlign="center",c.fillStyle=o.solvingColor,c.fillText(g,h,y)}}};for(var n in o.data.solving[e])t(n)};for(var t in o.data.solving)e(t)}}(),l=function(e,t){var n=o.elem.getContext("2d"),i=o.getCoordsByIndexes(e,t),r=i[0],a=i[1];n.fillStyle="rgba(108, 189, 244, 0.2)",n.fillRect(r,a,o.cellSize,o.cellSize)},s=function(e,t,n){var i=function(e,t,n,i){var r=o.getCoordsByIndexes(n,i),a=r[0],l=r[1];t.globalAlpha=.4,t.strokeStyle="rgb(108, 189, 244)",t.lineWidth=20;var s={upLeft:[a,l],upRight:[a+o.cellSize,l],downLeft:[a,l+o.cellSize],downRight:[a+o.cellSize,l+o.cellSize]};if("up"==e){var c=s.upLeft,d=s.upRight;t.moveTo(c[0],c[1]),t.lineTo(d[0],d[1])}if("down"==e){var u=s.downLeft,f=s.downRight;t.moveTo(u[0],u[1]),t.lineTo(f[0],f[1])}if("left"==e){var v=s.upLeft,g=s.downLeft;t.moveTo(v[0],v[1]),t.lineTo(g[0],g[1])}if("right"==e){var m=s.upRight,h=s.downRight;t.moveTo(m[0],m[1]),t.lineTo(h[0],h[1])}},r=function(e,t){var n=function(e,t,n){return"up"==e?0!=n&&o.selection[n-1][t]:"down"==e?n!=o.data.rows-1&&o.selection[n+1][t]:"left"==e?0!=t&&o.selection[n][t-1]:"right"==e?t!=o.data.rows-1&&o.selection[n][t+1]:void 0};return{up:n("up",e,t),down:n("down",e,t),left:n("left",e,t),right:n("right",e,t)}}(e,t);r.up||i("up",n,e,t),r.down||i("down",n,e,t),r.left||i("left",n,e,t),r.right||i("right",n,e,t)},function(){var e=o.selection;for(var t in e)for(var n in e[t])1==e[t][n]&&l(n,t)}(),function(){var e=o.elem.getContext("2d");e.beginPath();var t=o.selection;for(var n in t)for(var i in t[n])1==t[n][i]&&s(+i,+n,e);e.lineCap="round",e.stroke()}()}},r={writing:{mode:"solving",insertMode:"number",solvingMode:"number"},selectMode:"one"},a={visible:!0,showHide:function(){var e=!this.visible;return this.visible=e,o.draw(),this.visible},remove:function(){o.data.solving=createMatrixSolvingArray(o.data.rows,o.data.columns),o.draw()},apply:function(){for(var e in o.data.solving)for(var t in o.data.solving[e]){var n=o.data.solving[e][t][0],i=o.data.solving[e][t][1];0!=n?(o.data.solving[e][t]=[0,[],[]],o.data.values[e][t]=n):1==i.length&&(o.data.solving[e][t]=[0,[],[]],o.data.values[e][t]=i[0])}o.draw()}},l=function(e,t){var n=document.querySelector("*:focus");if(null==n||"INPUT"!=n.tagName){var i=function(e,t,n,i){var a=r.writing.mode,l=r.writing.insertMode,s=r.writing.solvingMode;if(0!=e)if(999!=e){if("insert"==a){if("number"==l)o.data.values[n][t]=e,o.data.solving[n][t]=[0,[],[]];else if("pair"==l){var c=o.data.values[n][t],d=String(c).length;0==d?o.data.values[n][t]=String(e):1==d?o.data.values[n][t]=c+""+String(e):2==d&&(o.data.values[n][t]=String(c)[1]+String(e))}}else if("solving"==a){var u=o.data.values[n][t];if(0!=u&&1==u.toString().length&&"painting"!=s)return;if("number"==s)o.data.solving[n][t][0]=e;else if("central"==s){var f=o.data.solving[n][t][1];if(0!=o.data.solving[n][t][0])return;if(0==f.length)o.data.solving[n][t][1].push(e);else{var v=o.data.solving[n][t][1].indexOf(e);if(-1==v){o.data.solving[n][t][1].push(e);var g=o.data.solving[n][t][1].sort((function(e,t){return e-t}));o.data.solving[n][t][1]=g}else i||o.data.solving[n][t][1].splice(v,1)}}else if("corner"==s){var m=o.data.solving[n][t][2];if(0!=o.data.solving[n][t][0])return;if(0==m.length)o.data.solving[n][t][2].push(e);else{var h=o.data.solving[n][t][2].indexOf(e);if(-1==h){o.data.solving[n][t][2].push(e);var y=o.data.solving[n][t][2].sort((function(e,t){return e-t}));o.data.solving[n][t][2]=y}else i||o.data.solving[n][t][2].splice(h,1)}}else if("painting"==s)if(0==o.data.solving[n][t].length)o.data.painting[n][t].push(e);else{var p=o.data.painting[n][t].indexOf(e);if(-1==p){o.data.painting[n][t].push(e);var w=o.data.painting[n][t].sort((function(e,t){return e-t}));o.data.painting[n][t]=w}else i||o.data.painting[n][t].splice(p,1)}}}else{if(0!=o.data.values[n][t])return;for(var b=[],S=1;S<=o.data.rows&&S<=9;S++)b.push(S);o.data.solving[n][t][1]=b}else"painting"==s?o.data.painting[n][t]=[]:o.data.solving[n][t]=[0,[],[]]},a=function(){var t=r.writing.mode,n=r.writing.solvingMode;if("insert"==t)return!1;var i=!1,a=!1;for(var l in o.selection)for(var s in o.selection[l])if(0==o.data.values[l][s]&&1==o.selection[l][s]&&("number"==n?o.data.solving[l][s][0]==e?i=!0:a=!0:"central"==n?-1!=o.data.solving[l][s][1].indexOf(e)?i=!0:a=!0:"corner"==n?-1!=o.data.solving[l][s][2].indexOf(e)?i=!0:a=!0:"painting"==n&&(-1!=o.data.painting[l][s].indexOf(e)?i=!0:a=!0),i&&a))return!0;return!1}();for(var l in o.selection)for(var s in o.selection[l])1==o.selection[l][s]&&i(e,s,l,a);var c=r.writing.mode,d=r.writing.solvingMode;"solving"==c&&"number"==d&&(o.checkSolving(t),o.updateProblemNumbers(o))}},s=function(e){o.deSelectAll(),999!=e&&0!=e&&function(e){!function(){for(var t in o.data.values)for(var n in o.data.values[t])o.data.values[t][n]==e&&(o.selection[t][n]=!0)}(),function(){for(var t in o.data.solving)for(var n in o.data.solving[t]){var i=o.data.solving[t][n],r=i[0]==e,a=-1!=i[1].indexOf(e),l=-1!=i[2].indexOf(e);(r||a||l)&&(o.selection[t][n]=!0)}}(),o.draw()}(e)},c=function(e,t,i,o,r){var a,l,s,c,d,u,f,v;!function(e,t,n,i,o){e("numbers",t,n,i,o),e("color",t,n,i,o)}((function(e,t,i,o,r){var a;a="color"==e?document.querySelectorAll("#painting-pad .num"):document.querySelectorAll("#numpad .num");var l,s={isLongPress:!1,longPressHappened:!1},c=n(a);try{var d=function(){var n=l.value,a=+n.getAttribute("data-key"),c=function(e,t,n,i,o){n.isLongPress=!0,n.longPressHappened=!1,setTimeout((function(){1==n.isLongPress&&"color"!=i&&(n.longPressHappened=!0,o(e))}),600)},d=function(e,t,n,i,o,a){o.isLongPress=!1,o.longPressHappened||(t(n,r),e.draw(),"color"!=a&&e.solvingStack.step())};n.onmousedown=function(n){return c(a,0,s,e,t)},n.onmouseup=function(t){return d(i,o,a,0,s,e)},n.addEventListener("touchstart",(function(n){return function(e,t,n,i,o,r){e.preventDefault(),t(n,e,i,o,r)}(n,c,a,s,e,t)}),{passive:!1}),n.addEventListener("touchend",(function(t){return d(i,o,a,0,s,e)}))};for(c.s();!(l=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}}),e,t,i,r),a=document.getElementById("numpad"),l=document.getElementById("painting-pad"),s=function(e,t){e.style.display="none",t.style.display="flex"},c=function(e,t){t.style.display="none",e.style.display="flex"},d=document.getElementById("solving-mode-number"),u=document.getElementById("solving-mode-central"),f=document.getElementById("solving-mode-corner"),v=document.getElementById("solving-mode-painting"),d.onclick=function(){return function(e,t,n,i,o,r,a,l){e(t,n),i.classList.remove("writing-mode-elem-active"),o.classList.remove("writing-mode-elem-active"),r.classList.add("writing-mode-elem-active"),a.classList.remove("writing-mode-elem-active"),l.writing.solvingMode="number"}(s,l,a,u,f,d,v,o)},u.onclick=function(){return function(e,t,n,i,o,r,a,l){e(t,n),i.classList.add("writing-mode-elem-active"),o.classList.remove("writing-mode-elem-active"),r.classList.remove("writing-mode-elem-active"),a.classList.remove("writing-mode-elem-active"),l.writing.solvingMode="central"}(s,l,a,u,f,d,v,o)},f.onclick=function(){return function(e,t,n,i,o,r,a,l){e(t,n),i.classList.remove("writing-mode-elem-active"),o.classList.add("writing-mode-elem-active"),r.classList.remove("writing-mode-elem-active"),a.classList.remove("writing-mode-elem-active"),l.writing.solvingMode="corner"}(s,l,a,u,f,d,v,o)},v.onclick=function(){return function(e,t,n,i,o,r,a,l){e(t,n),i.classList.remove("writing-mode-elem-active"),a.classList.add("writing-mode-elem-active"),o.classList.remove("writing-mode-elem-active"),r.classList.remove("writing-mode-elem-active"),l.writing.solvingMode="painting"}(c,l,a,u,f,d,v,o)}},d=function(e,t){var n=document.getElementById("select-mode-one"),i=document.getElementById("select-mode-multi"),o=document.getElementById("select-mode-all");n.onclick=function(){return function(e,t,n){n.classList.remove("select-mode-elem-active"),t.classList.add("select-mode-elem-active"),e.selectMode="one"}(t,n,i)},i.onclick=function(){return function(e,t,n){t.classList.remove("select-mode-elem-active"),n.classList.add("select-mode-elem-active"),e.selectMode="multi"}(t,n,i)},o.onclick=function(){return function(e){e.selectAll(),e.draw()}(e)}},u=function(e){var t=document.getElementById("menu-icon"),n=document.getElementById("menu"),i=document.getElementById("final-screen"),o=document.getElementById("help-icon"),r=document.getElementById("help"),a=document.getElementById("help-ok"),l=document.getElementById("final-ok");!function(e,t,i){t.onclick=function(){return function(e,t,n){"block"==e.style.display?e.style.display="none":(t.style.display="none",n.style.display="none",e.style.display="block")}(n,e,i)}}(r,t,i),function(e,t,n,i,o){e.onclick=t.onclick=function(){return function(e,t,n){"none"==e.style.display?(e.style.display="block",t.style.display="none",n.style.display="none"):e.style.display="none"}(n,i,o)}}(o,a,r,n,i),function(e,t){e.onclick=function(){return function(e){e.style.display="none"}(t)}}(l,i)},f=function(e){var t=document.getElementById("undo-button"),n=document.getElementById("redo-button");t.onclick=function(){return e.solvingStack.back()},n.onclick=function(){return e.solvingStack.forward()}},v=function(e,t,n,i,o,r){new FontFace("Roboto-Medium-numbers-only-numbers-only","url(assets/Roboto-Medium-numbers-only.ttf)").load().then((function(){return function(e,n,o,r){performance.mark("start"),e.init(),e.draw(),u(),function(e,t){var n=function(e,t,n){for(var i=n.cellSize,o=n.padding,r=[0,0],a=0;a<n.data.columns;a++)if(e<=o+i*(a+1)){r[0]=a;break}for(var l=0;l<n.data.rows;l++)if(t<=o+i*(l+1)){r[1]=l;break}return r},i=function(e,t,n){var i=n.padding,o=n.elem;return e<i||t<i||e>o.width-i||t>o.height-i},o=function(e,t,n){var i,o,r=n.elem,a=0,l=0;if("desktop"==t)i=e.offsetX,o=e.offsetY;else{var s=r.getBoundingClientRect();i=e.targetTouches[0].clientX-s.left,o=e.targetTouches[0].clientY-s.top}var c=r.clientWidth,d=r.clientHeight;return 0!=i&&(a=Math.round(r.width*i/c)),0!=o&&(l=Math.round(r.height*o/d)),[a,l]},r={setOfCells:new Set,activity:!1},a=function(e,t,n,i,o,r,a,l){e.preventDefault(),t.setOfCells.clear(),t.activity=!0;var s=r(e,n,o),c=s[0],d=s[1];if(i(c,d,o))return!1;var u=a(c,d,o),f=o.selection[u[1]][u[0]];0==o.isCtrlPressed&&"one"==l.selectMode&&o.deSelectAll(),o.selection[u[1]][u[0]]=!f,o.draw()},l=function(e,t,n,i,o,r,a){if(e.preventDefault(),t.activity){var l=r(e,n,i),s=l[0],c=l[1],d=a(s,c,i);if(o(s,c,i))return!1;i.selection[d[1]][d[0]]=!0,i.draw()}},s=function(e){e.activity=!1},c=e.elem;c.onmousedown=function(l){return a(l,r,"desktop",i,e,o,n,t)},c.addEventListener("touchstart",(function(l){return a(l,r,"mobile",i,e,o,n,t)}),{passive:!1}),c.onmouseup=c.onmouseleave=function(){return s(r)},c.addEventListener("touchend",(function(){return s(r)})),c.onmousemove=function(t){return l(t,r,"desktop",e,i,o,n)},c.addEventListener("touchmove",(function(t){return l(t,r,"mobile",e,i,o,n)}),{passive:!1}),function(e){e.elem.style.display="block"}(e)}(e,n),c(i,e,t,n,r),d(e,n),f(e),function(e,t,n,i){n.body.onkeydown=function(n){return function(e,t,n,o,r,a,l){if("Escape"==e)return r.call(o),void a.call(o);if("Control"!=e){if("Delete"==e||"Backspace"==e)return l(0,i),o.draw(),void o.solvingStack.step();if("a"!=e)if("ArrowRight"!=e&&"ArrowLeft"!=e&&"ArrowUp"!=e&&"ArrowDown"!=e);else{var s=0;for(var c in o.selection)for(var d in o.selection[c])1==o.selection[c][d]&&s++;1==s&&(o.moveSelection(e),t.call(n))}else 1==o.isCtrlPressed&&(o.selectAll(),o.draw())}else o.isCtrlPressed=!0}(n.key,n.preventDefault,n,e,e.deSelectAll,e.draw,t)},n.body.onkeyup=function(n){return function(e,t,n,i){var o=e.key;"Control"==o&&(t.isCtrlPressed=!1),-1!=["1","2","3","4","5","6","7","8","9","0"].indexOf(o)&&(n(+o,i),t.draw(),t.solvingStack.step())}(n,e,t,i)}}(e,t,o,r),function(e,t){t.body.onclick=function(n){return function(e,t,n,i,o){(e==t||e.classList.contains("empty")||"container"==e.id||"controls-row-2"==e.id)&&(n.call(o),i.call(o))}(n.target,t.body,e.deSelectAll,e.draw,e)}}(e,o),function(e){e.getElementById("container").style.display="inline-block"}(o),function(e){e.getElementById("loading").style.display="none"}(o),performance.mark("end"),console.log("загрузка интерфейса: "+performance.measure("time","start","end").duration+" мс")}(e,n,o,r)}))};window.onload=function(){return v(o,l,r,s,document,t)}})();